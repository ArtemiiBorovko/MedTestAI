<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>Medical Test AI</title>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="application-name" content="Medical Test AI" />
    <meta
      name="description"
      content="–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ –∞—Ä—Ö–∏–≤–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫–æ–º"
    />

    <!-- PWA –º–∞–Ω–∏—Ñ–µ—Å—Ç -->
    <link rel="manifest" href="/manifest.json" />

    <!-- –¶–≤–µ—Ç–∞ —Ç–µ–º—ã -->
    <meta name="theme-color" content="#121212" />
    <meta name="msapplication-TileColor" content="#121212" />

    <!-- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–∞-—Ç–µ–≥–∏ –¥–ª—è iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="MedTestAI" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />

    <!-- –ò–∫–æ–Ω–∫–∏ –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png" />

    <!-- –ò–∫–æ–Ω–∫–∏ –¥–ª—è Apple —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ (—Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã) -->
    <link rel="apple-touch-icon" href="/icon-192.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/icon-192.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="/icon-192.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icon-192.png" />

    <!-- Splash screen –¥–ª—è iOS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
    <link rel="apple-touch-startup-image" href="/icon-512.png" />
  </head>

  <body style="margin: 0; background-color: #121212">
    <div id="root"></div>
    <script type="module" src="/src/index.jsx"></script>

    <script>
      // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
      if ("serviceWorker" in navigator) {
        // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –î–û –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã
        navigator.serviceWorker
          .register("/sw.js")
          .then((registration) => {
            console.log(
              "‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:",
              registration.scope,
            );
            console.log(
              "üì± –†–µ–∂–∏–º PWA:",
              window.matchMedia("(display-mode: standalone)").matches
                ? "–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
                : "–ë—Ä–∞—É–∑–µ—Ä",
            );

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è SW
            registration.addEventListener("updatefound", () => {
              console.log("üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è Service Worker");
            });
          })
          .catch((err) => {
            console.error("‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ SW:", err);
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–¥—Å–∫–∞–∑–∫—É, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (err.message.includes("MIME")) {
              console.warn("‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è sw.js");
            }
          });

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è SW
        navigator.serviceWorker.addEventListener("controllerchange", () => {
          console.log("üîÑ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä Service Worker –∏–∑–º–µ–Ω–∏–ª—Å—è");
          window.location.reload(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ SW
        });
      }
    </script>
  </body>
</html>
